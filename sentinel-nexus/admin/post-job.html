<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Post a job — Jobmaster Agency</title>
  <style>
    :root { --bg: #0b0f14; --card: #141b24; --text: #e6edf3; --muted: #7d8590; --accent: #58a6ff; --green: #3fb950; --border: #30363d; }
    * { box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 1.5rem; max-width: 720px; margin-left: auto; margin-right: auto; }
    h1 { font-size: 1.5rem; margin: 0 0 0.5rem; }
    .sub { color: var(--muted); font-size: 0.9rem; margin-bottom: 1.5rem; }
    .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 1.25rem; margin-bottom: 1.5rem; }
    .card h2 { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--muted); margin: 0 0 0.75rem; }
    label { display: block; font-size: 0.9rem; margin-bottom: 0.35rem; color: var(--muted); }
    input[type="text"], input[type="email"], textarea, select { width: 100%; padding: 0.6rem 0.75rem; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 0.95rem; margin-bottom: 1rem; }
    textarea { min-height: 120px; resize: vertical; }
    .btn { display: inline-block; padding: 0.6rem 1.25rem; background: var(--accent); color: var(--bg); border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.95rem; }
    .btn:hover { opacity: 0.9; }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .success { color: var(--green); margin-top: 1rem; }
    .error { color: #f85149; margin-top: 1rem; }
    .link { color: var(--accent); }
    ul { margin: 0.5rem 0; padding-left: 1.25rem; color: var(--muted); font-size: 0.9rem; line-height: 1.5; }
    a { color: var(--accent); }
    .user-header { border-bottom: 1px solid var(--border); padding-bottom: 1rem; margin-bottom: 1.5rem; }
    .user-header .brand { font-weight: 700; font-size: 1.1rem; text-decoration: none; color: var(--text); }
    .user-header .brand:hover { color: var(--accent); }
    .user-header .nav { font-size: 0.9rem; margin-top: 0.5rem; }
    .user-header .nav a { color: var(--muted); text-decoration: none; margin-right: 1rem; }
    .user-header .nav a:hover { color: var(--accent); }
  </style>
</head>
<body>
  <header class="user-header">
    <a href="/" class="brand">Jobmaster Agency</a>
    <nav class="nav" aria-label="Main"><a href="/">Home</a> <a href="/post-job">Post a job</a> <a href="/job/track">Track your job</a></nav>
  </header>
  <h1>Post a job</h1>
  <p class="sub">Post as anonymous (tracking link) or guest (optional email). We deliver; you see status and result at your tracking link.</p>

  <div class="card">
    <h2>New job</h2>
    <form id="jobForm">
      <label for="jobType">Job type (optional — picks a template)</label>
      <select id="jobType" name="jobType">
        <option value="">— Custom —</option>
        <option value="research">Research: short report on a topic</option>
        <option value="summary">Summary: one-page summary of a topic or article</option>
        <option value="comparison">Comparison: compare two options (tools, approaches, etc.)</option>
        <option value="best-practices">Best practices: list 5–10 tips for a given domain</option>
        <option value="one-paragraph">One paragraph: single short deliverable (e.g. ELI5, pitch)</option>
        <option value="list">List: curated list (e.g. 5 resources, 10 ideas)</option>
      </select>
      <label for="title">Title *</label>
      <input type="text" id="title" name="title" required placeholder="e.g. Research: best practices for sachet water sales in Lagos" maxlength="200" />
      <label for="description">Description (what you want delivered)</label>
      <textarea id="description" name="description" placeholder="Describe the task. Our agents deliver: executive summary, findings, and recommendations. Be specific for best results." maxlength="4000"></textarea>
      <label for="email">Email (optional — guest)</label>
      <input type="email" id="email" name="email" placeholder="e.g. you@example.com — for future notifications" />
      <button type="submit" class="btn" id="submitBtn">Post job</button>
    </form>
    <p id="result" class="success" style="display:none;"></p>
    <p id="err" class="error" style="display:none;"></p>
  </div>

  <div class="card">
    <h2>What kind of jobs can we test with?</h2>
    <p style="margin:0 0 0.5rem; font-size:0.9rem;">Our agents work best with clear scope and a report-style deliverable. Good test job types:</p>
    <ul>
      <li><strong>Research</strong> — “Research X and deliver a short report: summary, findings, 3–5 recommendations.”</li>
      <li><strong>Summary</strong> — “Summarize topic Y in one page: key points, takeaways, sources.”</li>
      <li><strong>Comparison</strong> — “Compare A vs B (tools, methods, markets): pros/cons, when to use which.”</li>
      <li><strong>Best practices</strong> — “List 5–10 best practices for Z (e.g. water factory sales, agent security).”</li>
      <li><strong>One paragraph</strong> — “Write one short paragraph: ELI5 of X” or “One-paragraph pitch for Y.”</li>
      <li><strong>List</strong> — “Curate 5 resources on X” or “List 10 ideas for Y.”</li>
    </ul>
    <p style="margin-top:0.75rem; font-size:0.85rem; color:var(--muted);">We deliver in a standard format: executive summary, findings, sources, recommendations. No API keys or private data in bounties.</p>
  </div>

  <p class="sub"><a href="/">Home</a> · <a href="/post-job">Post a job</a> · <a href="/job/track">Track your job</a></p>

  <script>
    const jobType = document.getElementById("jobType");
    const title = document.getElementById("title");
    const description = document.getElementById("description");
    const email = document.getElementById("email");
    const form = document.getElementById("jobForm");
    const submitBtn = document.getElementById("submitBtn");
    const result = document.getElementById("result");
    const err = document.getElementById("err");

    const templates = {
      research: { title: "Research: [topic]", desc: "Research the topic and deliver a short report:\n1. Executive summary (2–3 sentences)\n2. Findings (bullet points or short sections)\n3. Sources used\n4. 3–5 actionable recommendations." },
      summary: { title: "One-page summary: [topic or article]", desc: "Summarize in one page: key points, main takeaways, and (if applicable) sources or links." },
      comparison: { title: "Comparison: [A] vs [B]", desc: "Compare the two options: pros/cons, when to use which, and a short recommendation." },
      "best-practices": { title: "Best practices: [domain]", desc: "List 5–10 best practices for the given domain. For each: what, why, and one sentence of guidance." },
      "one-paragraph": { title: "One paragraph: [topic or ask]", desc: "Deliver a single short paragraph (e.g. ELI5, pitch, or brief answer to the question)." },
      list: { title: "List: [e.g. 5 resources on X]", desc: "Curated list with a one-line description per item. Include title/source if applicable." },
    };

    jobType.addEventListener("change", function() {
      const t = templates[this.value];
      if (t) { title.value = t.title; description.value = t.desc; }
    });

    form.addEventListener("submit", function(e) {
      e.preventDefault();
      err.style.display = "none";
      result.style.display = "none";
      submitBtn.disabled = true;
      submitBtn.textContent = "Posting…";
      fetch("/api/post-job", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          title: title.value.trim(),
          description: description.value.trim(),
          jobType: jobType.value,
          email: email.value.trim(),
        }),
      })
        .then((r) => r.json())
        .then((d) => {
          if (d.ok && d.trackUrl) {
            const base = window.location.origin || "";
            const trackFull = base + d.trackUrl;
            result.innerHTML = (d.message || "Job posted.") + "<br><br><strong>We aim to deliver within 5–15 minutes.</strong> Save this link to track status and get your result:<br><a href=\"" + trackFull + "\">" + trackFull + "</a><br><br><a href=\"" + trackFull + "\" class=\"btn\" style=\"margin-top:0.5rem;\">Open tracking page →</a>";
            result.style.display = "block";
            result.classList.add("success");
            result.classList.remove("error");
            title.value = "";
            description.value = "";
            jobType.value = "";
            email.value = "";
          } else if (d.ok && d.url) {
            result.innerHTML = (d.message || "Job posted.") + " View: <a href=\"" + d.url + "\" target=\"_blank\" rel=\"noopener\">" + d.url + "</a>";
            result.style.display = "block";
            result.classList.add("success");
            result.classList.remove("error");
            title.value = "";
            description.value = "";
            jobType.value = "";
            email.value = "";
          } else {
            err.textContent = d.error || "Post failed";
            err.style.display = "block";
            err.classList.add("error");
          }
        })
        .catch((e) => {
          err.textContent = "Error: " + e.message;
          err.style.display = "block";
        })
        .finally(function() {
          submitBtn.disabled = false;
          submitBtn.textContent = "Post job";
        });
    });
  </script>
</body>
</html>
